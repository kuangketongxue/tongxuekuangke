<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆåŠŸæ—¥è®°</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.0/dist/av-min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <a href="../" class="back-btn">â† è¿”å›é¦–é¡µ</a>
            <h1>ğŸ“ æˆåŠŸæ—¥è®°</h1>
            <p class="subtitle">å½“ä½ å†™æˆåŠŸæ—¥è®°çš„æ—¶å€™ï¼Œä½ ä¼šå¯¹è‡ªå·±ï¼Œå¯¹ä¸–ç•Œï¼Œè¿˜æœ‰å¯¹æˆåŠŸçš„è§„å¾‹ä½œæ›´æ·±å…¥çš„æ€è€ƒï¼Œä¼šè¶Šæ¥è¶Šå¤šåœ°äº†è§£è‡ªå·±å’Œè‡ªå·±çš„æ„¿æœ›ï¼Œè¿™æ ·ä½ æ‰ä¼šæœ‰èƒ½åŠ›å»ç†è§£åˆ«äººã€‚å½»åº•äº†è§£è‡ªå·±å’Œä¸–ç•Œä¸Šçš„æ‰€æœ‰ç§˜å¯†ï¼Œæ˜¯æˆ‘ä»¬æ— æ³•å®Œå…¨å®ç°çš„ä¸€ç§ç†æƒ³ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä¸€æ­¥ä¸€æ­¥åœ°æ…¢æ…¢æ¥è¿‘è¿™ç§ç†æƒ³ã€‚ä¸€ä¸ªäººæŒ£é’±çš„å¤šå°‘æ˜¯å’Œä»–çš„è‡ªä¿¡å¿ƒè”ç³»åœ¨ä¸€èµ·çš„ã€‚å¦å¤–,ä»–çš„ç²¾åŠ›ç©¶ç«Ÿæ˜¯é›†ä¸­åœ¨è‡ªå·±çš„èƒ½åŠ›èŒƒå›´ä¹‹å†…,è¿˜æ˜¯æ”¾åˆ°äº†ä»–åŠ›æ‰€ä¸èƒ½åŠçš„äº‹æƒ…ä¸Š,è¿™ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ä¸€ç‚¹ã€‚æ²¡æœ‰æˆ‘çš„æˆåŠŸæ—¥è®°æœ¬,æˆ‘å°±ä¸ä¼šå»æ€è€ƒè‡ªå·±é€‚åˆåœ¨å“ªäº›æ–¹é¢èµšé’±ã€‚</p>
        </header>
        
        <div id="diary-container" class="diary-list">
            <!-- åŠ¨æ€åŠ è½½å†…å®¹ -->
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="social-footer">
        <div class="container">
            <div class="social-links">
                <a href="https://open.weixin.qq.com/qr/code?username=gh_ba5b6bb6bd89"
                   target="_blank" class="social-link wechat" title="å¾®ä¿¡å…¬ä¼—å·" rel="noopener noreferrer">
                    <i class="fab fa-weixin"></i>
                </a>
                <a href="https://github.com/kuangketongxue" target="_blank" class="social-link github" title="GitHub" rel="noopener noreferrer">
                    <i class="fab fa-github"></i>
                </a>
                <a href="https://x.com/kuangketongxue" target="_blank" class="social-link x" title="X (å‰ Twitter)" rel="noopener noreferrer">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                    </svg>
                </a>
            </div>
            <p class="copyright">Â© 2025 ç‹‚å®¢Â·é“¶æ²³ ç‰ˆæƒæ‰€æœ‰</p>
        </div>
    </footer>

    <script src="../assets/js/leancloud.js"></script>
    <script>
        initLeanCloud();
        
        async function loadDiary() {
            try {
                console.log('å¼€å§‹åŠ è½½æ—¥è®°æ•°æ®...');
                const response = await fetch('data/diary.json');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const diaries = await response.json();
                console.log('æ—¥è®°æ•°æ®:', diaries);
                renderDiary(diaries);
            } catch (error) {
                console.error('åŠ è½½å¤±è´¥:', error);
                
                // å¦‚æœåŠ è½½å¤±è´¥ï¼Œæ˜¾ç¤ºç¤ºä¾‹æ•°æ®
                const sampleDiaries = [
                    {
                        "id": "diary-20241225",
                        "date": "2024-12-25",
                        "title": "ä»Šå¤©å®Œæˆäº†é‡è¦çš„å­¦ä¹ ç›®æ ‡",
                        "category": "å­¦ä¹ æˆé•¿",
                        "content": "ä»Šå¤©èŠ±äº†æ•´ä¸ªä¸‹åˆç³»ç»Ÿå­¦ä¹ äº†æ–°çš„ç¼–ç¨‹æŠ€æœ¯ï¼Œè™½ç„¶è¿‡ç¨‹æœ‰ç‚¹ç´¯ï¼Œä½†æ˜¯æ”¶è·å¾ˆå¤§ã€‚å®Œæˆäº†3ä¸ªç»ƒä¹ é¡¹ç›®ï¼Œä»£ç èƒ½åŠ›åˆæå‡äº†ä¸€ä¸ªå°é˜¶ã€‚",
                        "achievement": "æŒæ¡äº†æ–°çš„ç¼–ç¨‹æŠ€æœ¯æ ˆ",
                        "reflection": "åšæŒçš„åŠ›é‡æ˜¯å·¨å¤§çš„ï¼Œæ¯å¤©çš„ç§¯ç´¯éƒ½ä¼šå˜æˆæœªæ¥çš„æ”¶è·ã€‚",
                        "tags": ["å­¦ä¹ ", "ç¼–ç¨‹", "è¿›æ­¥"]
                    }
                ];
                renderDiary(sampleDiaries);
            }
        }
        
        function renderDiary(diaries) {
            const container = document.getElementById('diary-container');
            
            if (!diaries || diaries.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999;">æš‚æ— æ—¥è®°å†…å®¹</p>';
                return;
            }
            
            container.innerHTML = diaries.map(diary => `
                <div class="diary-card" data-id="${diary.id}">
                    <div class="diary-header">
                        <h3>${diary.title}</h3>
                        <span class="diary-date">${diary.date}</span>
                    </div>
                    ${diary.category ? `
                        <div class="diary-category">
                            <span class="category-badge">${diary.category}</span>
                        </div>
                    ` : ''}
                    <div class="diary-content">
                        ${diary.content.replace(/\n/g, '<br>')}
                    </div>
                    ${diary.achievement ? `
                        <div class="diary-achievement">
                            <h4>ğŸ† æˆå°±</h4>
                            <p>${diary.achievement}</p>
                        </div>
                    ` : ''}
                    ${diary.reflection ? `
                        <div class="diary-reflection">
                            <h4>ğŸ’­ åæ€</h4>
                            <p>${diary.reflection}</p>
                        </div>
                    ` : ''}
                    ${diary.tags && diary.tags.length > 0 ? `
                        <div class="diary-tags">
                            ${diary.tags.map(tag => `<span class="tag">#${tag}</span>`).join('')}
                        </div>
                    ` : ''}
                    <div class="moment-actions">
                        <button class="like-btn" onclick="handleLike('diary', '${diary.id}')">
                            ğŸ‘ <span class="like-count">0</span>
                        </button>
                        <button class="comment-btn" onclick="showComments('${diary.id}')">
                            ğŸ’¬ è¯„è®º
                        </button>
                    </div>
                    <div id="comments-${diary.id}" class="comments-section" style="display:none;">
                        <!-- è¯„è®ºåŒº -->
                    </div>
                </div>
            `).join('');
            
            // åŠ è½½äº’åŠ¨æ•°æ®
            diaries.forEach(diary => {
                if (typeof loadInteractions === 'function') {
                    loadInteractions('diary', diary.id);
                }
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè°ƒç”¨
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹åŠ è½½æ—¥è®°');
            loadDiary();
        });
        
        // ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
        loadDiary();
    </script>
</body>
</html>
